package org.jlinda.core.coregistration.utils;

import org.jblas.ComplexDouble;
import org.jblas.ComplexDoubleMatrix;
import org.jblas.DoubleMatrix;
import org.junit.FixMethodOrder;
import org.junit.Test;
import org.junit.runners.MethodSorters;


@FixMethodOrder(MethodSorters.NAME_ASCENDING)
public class CoregistrationUtilsTest {

    @Test
    public void firstTest_localSum() throws Exception {
        final double[][] m = {{3, 1, 4}, {1, 5, 9}, {2, 6, 5}};
        final DoubleMatrix M = new DoubleMatrix(m);
        final DoubleMatrix localSumTable = CoregistrationUtils.computeLocalSum(M, 3, 3);
        for (int i = 0; i < 5; i++) {
            for (int j = 0; j < 5; j++) {
                System.out.print(localSumTable.get(i, j) + ", ");
            }
            System.out.println();
        }
        // The result should be
        // 3.0, 4.0, 8.0, 5.0, 4.0,
        // 4.0, 10.0, 23.0, 19.0, 13.0,
        // 6.0, 18.0, 36.0, 30.0, 18.0,
        // 3.0, 14.0, 28.0, 25.0, 14.0,
        // 2.0, 8.0, 13.0, 11.0, 5.0,

        // test matrix square calculation
        final DoubleMatrix M2 = M.mul(M);
        System.out.println();
        for (int i = 0; i < 3; i++) {
            for (int j = 0; j < 3; j++) {
                System.out.print(M2.get(i, j) + ", ");
            }
            System.out.println();
        }

        // test matrix std calculation
        final double mean = M.mean();
        final DoubleMatrix MCol = M.dup();
        MCol.subi(mean);
        MCol.muli(MCol);
        final double mStd = Math.sqrt(MCol.mean());
        System.out.println();
        System.out.println("Mean = " + mean + ", Std = " + mStd);
    }

    @Test
    public void secondTest_XCorrelation() throws Exception {

        // Test data: sI is mI shifted in range direction by 0.3 pixel
        final double[][] mI = { {147, 145, 102, 82, 92, 119, 110, 101, 95, 97, 105, 96, 77, 81, 91, 68, 59, 68, 56, 57, 52, 51, 73, 53, 33, 56, 82, 81, 65, 79, 78, 57},
                {108, 115, 100, 99, 87, 112, 126, 116, 100, 67, 74, 76, 65, 67, 67, 72, 62, 50, 55, 63, 51, 68, 104, 90, 65, 89, 110, 88, 79, 96, 99, 92},
                {72, 66, 76, 88, 66, 76, 96, 102, 125, 112, 86, 72, 60, 66, 86, 105, 93, 64, 55, 63, 40, 71, 103, 98, 63, 65, 104, 104, 109, 113, 124, 131},
                {140, 83, 43, 64, 49, 59, 68, 76, 119, 118, 93, 70, 58, 69, 82, 86, 82, 79, 64, 58, 61, 70, 83, 84, 56, 49, 87, 97, 108, 118, 112, 105},
                {167, 106, 66, 86, 69, 66, 71, 68, 94, 80, 68, 59, 49, 64, 67, 76, 97, 102, 78, 76, 74, 82, 87, 65, 56, 87, 107, 92, 98, 108, 91, 86},
                {149, 124, 107, 119, 90, 58, 87, 85, 89, 86, 72, 54, 44, 63, 89, 113, 141, 145, 105, 87, 70, 91, 115, 83, 71, 102, 100, 67, 83, 82, 65, 72},
                {119, 109, 110, 114, 77, 53, 90, 96, 89, 104, 95, 60, 41, 64, 96, 94, 114, 122, 102, 95, 66, 82, 116, 110, 102, 98, 79, 52, 80, 83, 68, 102},
                {88, 94, 95, 74, 61, 67, 72, 92, 84, 83, 91, 66, 39, 68, 89, 98, 107, 91, 90, 94, 77, 79, 94, 115, 129, 100, 80, 66, 57, 70, 95, 141},
                {93, 83, 74, 69, 77, 78, 72, 98, 106, 89, 85, 66, 42, 80, 98, 123, 117, 91, 91, 84, 98, 120, 110, 104, 109, 76, 51, 63, 51, 52, 91, 115},
                {132, 111, 101, 119, 108, 89, 77, 101, 117, 98, 68, 50, 75, 113, 121, 120, 86, 44, 71, 85, 112, 129, 111, 89, 74, 56, 46, 48, 57, 62, 62, 66},
                {142, 130, 115, 120, 138, 119, 70, 96, 107, 79, 75, 83, 96, 109, 109, 106, 88, 75, 89, 103, 107, 109, 105, 103, 99, 106, 105, 89, 77, 64, 65, 76},
                {146, 102, 78, 101, 138, 134, 77, 107, 120, 91, 96, 84, 68, 72, 83, 104, 88, 60, 71, 76, 75, 94, 103, 102, 111, 129, 132, 124, 103, 89, 99, 87},
                {122, 124, 121, 120, 122, 119, 102, 120, 129, 105, 93, 67, 64, 91, 99, 105, 98, 78, 83, 89, 82, 85, 88, 77, 73, 113, 146, 139, 109, 108, 109, 80},
                {65, 112, 144, 142, 133, 113, 105, 113, 122, 119, 92, 80, 102, 113, 106, 86, 91, 106, 101, 102, 118, 125, 126, 109, 73, 96, 161, 178, 136, 99, 100, 98},
                {114, 131, 149, 151, 137, 95, 84, 114, 125, 126, 99, 77, 119, 146, 140, 112, 74, 87, 99, 103, 135, 156, 151, 130, 113, 121, 159, 184, 145, 82, 72, 94},
                {151, 175, 165, 147, 130, 96, 92, 112, 122, 116, 88, 76, 123, 152, 141, 116, 88, 98, 117, 106, 127, 161, 151, 123, 125, 139, 150, 155, 118, 73, 77, 110},
                {130, 167, 158, 150, 145, 132, 131, 107, 122, 146, 129, 97, 102, 118, 114, 106, 108, 103, 102, 88, 116, 157, 130, 93, 108, 123, 133, 125, 109, 103, 119, 139},
                {130, 166, 163, 142, 158, 140, 145, 125, 110, 136, 146, 116, 121, 149, 149, 113, 86, 92, 81, 72, 108, 134, 85, 51, 75, 75, 82, 121, 167, 156, 125, 120},
                {171, 140, 150, 137, 187, 202, 159, 140, 129, 119, 115, 121, 154, 183, 190, 128, 89, 100, 80, 83, 114, 125, 92, 94, 106, 100, 88, 131, 175, 153, 97, 91},
                {200, 138, 174, 170, 200, 246, 189, 177, 203, 181, 153, 146, 151, 182, 210, 156, 111, 129, 129, 139, 148, 150, 140, 136, 116, 129, 129, 112, 136, 122, 107, 128},
                {188, 190, 223, 191, 170, 210, 201, 234, 245, 187, 161, 176, 192, 198, 202, 167, 101, 128, 163, 169, 164, 146, 126, 122, 102, 114, 104, 91, 149, 149, 140, 161},
                {215, 232, 228, 175, 149, 159, 223, 276, 273, 201, 151, 197, 249, 264, 260, 220, 167, 164, 180, 174, 158, 129, 87, 100, 121, 111, 79, 95, 148, 164, 169, 179},
                {314, 310, 254, 164, 169, 185, 244, 278, 254, 198, 184, 229, 290, 321, 339, 303, 253, 225, 198, 207, 174, 136, 142, 169, 158, 120, 104, 104, 114, 126, 130, 130},
                {316, 289, 243, 202, 198, 226, 246, 236, 190, 187, 219, 252, 303, 281, 295, 305, 284, 265, 236, 267, 251, 216, 205, 221, 196, 145, 117, 90, 96, 97, 87, 110},
                {313, 242, 177, 215, 193, 216, 261, 256, 228, 251, 236, 205, 231, 174, 182, 228, 257, 270, 237, 252, 245, 250, 226, 234, 242, 174, 120, 142, 200, 201, 182, 199},
                {349, 322, 243, 225, 190, 212, 320, 360, 319, 301, 317, 273, 208, 185, 176, 176, 209, 236, 213, 177, 109, 158, 164, 189, 230, 197, 166, 205, 288, 273, 214, 197},
                {233, 253, 250, 248, 196, 217, 359, 407, 354, 315, 379, 384, 303, 246, 198, 170, 195, 240, 222, 154, 116, 102, 102, 135, 152, 204, 219, 198, 260, 257, 217, 169},
                {201, 146, 152, 216, 186, 187, 263, 289, 286, 284, 307, 332, 302, 236, 174, 160, 222, 253, 223, 190, 179, 156, 167, 184, 144, 168, 190, 154, 190, 197, 196, 194},
                {333, 222, 152, 185, 193, 169, 126, 146, 241, 254, 204, 245, 235, 201, 208, 179, 225, 222, 204, 233, 202, 190, 209, 199, 134, 123, 146, 120, 134, 163, 177, 220},
                {319, 215, 141, 143, 157, 153, 218, 302, 303, 248, 219, 252, 206, 199, 247, 224, 232, 178, 162, 256, 272, 249, 234, 222, 207, 199, 173, 136, 144, 223, 217, 186},
                {245, 218, 184, 140, 97, 114, 224, 316, 279, 218, 211, 212, 190, 184, 185, 209, 235, 170, 159, 234, 272, 268, 240, 258, 296, 241, 160, 175, 194, 228, 213, 157},
                {262, 282, 262, 183, 134, 139, 164, 194, 182, 152, 160, 182, 179, 161, 149, 185, 215, 202, 177, 169, 189, 202, 167, 187, 237, 170, 159, 228, 208, 147, 147, 172}};

        final double[][] sIr = {
                {1.1917553e+02, 1.5942433e+02, 1.1022364e+02, 8.7774786e+01, 8.3126727e+01, 1.1497089e+02, 1.1409212e+02, 1.0312418e+02, 9.6414492e+01, 9.5138041e+01, 1.0332853e+02, 1.0111764e+02, 8.1527638e+01, 7.6776186e+01, 9.1073324e+01, 7.6633885e+01, 5.7528046e+01, 6.7138330e+01, 6.0215084e+01, 5.4750475e+01, 5.6202721e+01, 4.6730256e+01, 6.9018713e+01, 6.2732524e+01, 3.4811459e+01, 4.5711011e+01, 7.7313052e+01, 8.3310565e+01, 6.9803718e+01, 6.9807553e+01, 8.7786414e+01, 5.1218149e+01},
                {1.0093080e+02, 1.1734611e+02, 1.0282511e+02, 1.0029419e+02, 8.9037866e+01, 1.0103983e+02, 1.2695632e+02, 1.1812118e+02, 1.0821502e+02, 7.4386752e+01, 6.8647007e+01, 7.9050540e+01, 6.6497244e+01, 6.6570744e+01, 6.6351351e+01, 7.1202323e+01, 6.6597382e+01, 5.2220856e+01, 5.1630409e+01, 6.2784693e+01, 5.4600414e+01, 5.7601739e+01, 9.6552251e+01, 9.9462296e+01, 6.8172778e+01, 7.8025360e+01, 1.0871898e+02, 9.6460578e+01, 7.7467385e+01, 9.0942636e+01, 1.0044855e+02, 9.2841306e+01},
                {8.8434334e+01, 6.2362888e+01, 7.3104737e+01, 8.6406970e+01, 7.4159134e+01, 6.6940770e+01, 9.4145130e+01, 9.7398625e+01, 1.1981002e+02, 1.2012221e+02, 9.1968175e+01, 7.6360113e+01, 6.2041586e+01, 6.2632491e+01, 7.8492019e+01, 1.0213657e+02, 9.9243434e+01, 7.3244427e+01, 5.2596178e+01, 6.4834217e+01, 4.4594886e+01, 5.6455587e+01, 9.7802861e+01, 1.0314700e+02, 7.3991254e+01, 5.6744970e+01, 9.4772334e+01, 1.0695220e+02, 1.0470944e+02, 1.1451168e+02, 1.1596656e+02, 1.3791721e+02},
                {1.3355717e+02, 1.0919210e+02, 4.2844385e+01, 6.0851355e+01, 5.3935850e+01, 5.2617122e+01, 6.8528053e+01, 6.8810624e+01, 1.0712602e+02, 1.2424413e+02, 9.9684794e+01, 7.7247500e+01, 5.8555493e+01, 6.4734390e+01, 7.8553722e+01, 8.6272637e+01, 8.2929360e+01, 8.0782424e+01, 6.9094081e+01, 5.7779523e+01, 6.0203406e+01, 6.5905553e+01, 8.0018363e+01, 8.5775810e+01, 6.7014617e+01, 4.3310578e+01, 7.7191122e+01, 9.5550506e+01, 1.0424767e+02, 1.1530910e+02, 1.1739375e+02, 1.0073880e+02},
                {1.4977575e+02, 1.3662858e+02, 6.3954689e+01, 8.4143494e+01, 7.4861481e+01, 6.4094937e+01, 7.1551368e+01, 6.6068945e+01, 8.6748163e+01, 8.8843399e+01, 6.7814101e+01, 6.4814693e+01, 4.7967646e+01, 6.0141121e+01, 6.6599815e+01, 7.1811754e+01, 9.0244492e+01, 1.0485942e+02, 8.4738210e+01, 7.4343711e+01, 7.5762207e+01, 7.6911851e+01, 8.9578393e+01, 7.1666874e+01, 5.5643178e+01, 7.3825769e+01, 1.0780607e+02, 9.4457412e+01, 9.5778288e+01, 1.0432631e+02, 1.0275628e+02, 7.3481593e+01},
                {1.3084639e+02, 1.4029025e+02, 1.0405557e+02, 1.1866336e+02, 1.0306314e+02, 6.1147719e+01, 7.6966466e+01, 8.9587077e+01, 8.4663551e+01, 9.0695262e+01, 7.4916005e+01, 6.1193767e+01, 4.2991334e+01, 5.6126903e+01, 8.0851447e+01, 1.0621654e+02, 1.3202952e+02, 1.5026913e+02, 1.1687855e+02, 9.0318703e+01, 7.4810131e+01, 7.8470625e+01, 1.1516505e+02, 9.3692069e+01, 6.9835966e+01, 9.0474011e+01, 1.0956515e+02, 7.1006216e+01, 7.8066322e+01, 8.3716313e+01, 7.2814462e+01, 5.8612995e+01},
                {1.1851132e+02, 1.1207782e+02, 1.0775578e+02, 1.1556194e+02, 9.2037217e+01, 5.2190302e+01, 7.7995955e+01, 9.9436942e+01, 8.7963412e+01, 9.9838247e+01, 1.0185730e+02, 7.0748331e+01, 4.2849702e+01, 5.2964808e+01, 9.0083951e+01, 9.5225948e+01, 1.0488682e+02, 1.2533406e+02, 1.0615805e+02, 9.8858940e+01, 7.4209613e+01, 7.0178710e+01, 1.1041434e+02, 1.1349441e+02, 1.0383307e+02, 9.9116992e+01, 8.8282148e+01, 5.5420468e+01, 6.8612273e+01, 8.8917686e+01, 6.7312410e+01, 8.9871050e+01},
                {1.0515995e+02, 8.5049919e+01, 1.0065388e+02, 7.9175888e+01, 6.3480361e+01, 6.4269829e+01, 6.9736825e+01, 8.6240407e+01, 8.9606904e+01, 7.9481209e+01, 9.1479126e+01, 7.6717973e+01, 4.2249527e+01, 5.5643266e+01, 8.6743730e+01, 9.3555880e+01, 1.0720721e+02, 9.6402319e+01, 8.7328452e+01, 9.5668699e+01, 8.1724244e+01, 7.5897193e+01, 8.9071862e+01, 1.0798717e+02, 1.2830952e+02, 1.1195715e+02, 8.1779351e+01, 7.3379711e+01, 5.4240313e+01, 6.8741424e+01, 7.9534117e+01, 1.3752659e+02},
                {1.0044681e+02, 8.4388601e+01, 7.7347947e+01, 6.9027154e+01, 7.3770848e+01, 8.0271482e+01, 7.0853458e+01, 8.8922661e+01, 1.0791500e+02, 9.3979244e+01, 8.4742433e+01, 7.6402117e+01, 4.2434469e+01, 6.7048063e+01, 9.4911453e+01, 1.1433038e+02, 1.2532530e+02, 9.5185719e+01, 9.1134231e+01, 8.5735807e+01, 9.0513293e+01, 1.1621817e+02, 1.1520016e+02, 1.0292313e+02, 1.0983986e+02, 8.9589927e+01, 5.2501694e+01, 6.0359726e+01, 5.6320129e+01, 4.7294623e+01, 7.7101708e+01, 1.1396441e+02},
                {1.1539548e+02, 1.2562092e+02, 9.5416141e+01, 1.1762463e+02, 1.1202004e+02, 9.5925438e+01, 7.6810071e+01, 9.1730020e+01, 1.1619295e+02, 1.0598777e+02, 7.7115528e+01, 5.1732781e+01, 6.3385237e+01, 1.0388836e+02, 1.2127295e+02, 1.2061394e+02, 1.0249440e+02, 4.8833407e+01, 6.0911236e+01, 8.2264543e+01, 1.0161406e+02, 1.2831621e+02, 1.1841879e+02, 9.4299297e+01, 7.9038527e+01, 6.0694845e+01, 4.8426268e+01, 4.5175091e+01, 5.5827724e+01, 5.8948668e+01, 6.5828533e+01, 5.6176145e+01},
                {1.2507063e+02, 1.4137688e+02, 1.1422996e+02, 1.1892164e+02, 1.3110464e+02, 1.3376276e+02, 7.8036033e+01, 8.3746580e+01, 1.1048867e+02, 8.6714622e+01, 7.3295484e+01, 8.0696748e+01, 9.1029645e+01, 1.0662851e+02, 1.0951826e+02, 1.0776140e+02, 9.4945011e+01, 7.5785338e+01, 8.3379140e+01, 1.0006164e+02, 1.0629470e+02, 1.0868471e+02, 1.0672318e+02, 1.0308766e+02, 1.0049816e+02, 1.0200171e+02, 1.0906471e+02, 9.2143711e+01, 8.2508426e+01, 6.4755524e+01, 6.6691196e+01, 6.4992716e+01},
                {1.3156307e+02, 1.2491419e+02, 7.4212115e+01, 9.5100213e+01, 1.2422131e+02, 1.4725372e+02, 8.7601254e+01, 9.2019289e+01, 1.2463711e+02, 9.7171867e+01, 9.3050464e+01, 9.1036890e+01, 6.9899081e+01, 7.0305601e+01, 7.7956282e+01, 9.9134348e+01, 9.7923334e+01, 6.4323990e+01, 6.5879664e+01, 7.6759408e+01, 7.3532888e+01, 8.7177764e+01, 1.0309238e+02, 1.0105759e+02, 1.0770141e+02, 1.2291076e+02, 1.3461536e+02, 1.2512639e+02, 1.1340738e+02, 8.5972264e+01, 1.0211147e+02, 8.2331157e+01},
                {1.0780481e+02, 1.2910058e+02, 1.1886143e+02, 1.2223887e+02, 1.1926079e+02, 1.2352674e+02, 1.0445839e+02, 1.1190905e+02, 1.3122978e+02, 1.1206983e+02, 9.6350927e+01, 7.6056461e+01, 5.9101258e+01, 8.4080370e+01, 9.7940297e+01, 1.0307138e+02, 1.0298312e+02, 8.2445513e+01, 7.9175197e+01, 8.9342520e+01, 8.3788250e+01, 8.2964381e+01, 8.8455280e+01, 8.1405621e+01, 7.0415726e+01, 9.7607895e+01, 1.4107842e+02, 1.4394218e+02, 1.1874218e+02, 1.0231505e+02, 1.1623199e+02, 8.2045708e+01},
                {6.9423845e+01, 9.2181507e+01, 1.4148120e+02, 1.4224415e+02, 1.3799474e+02, 1.1825972e+02, 1.0573901e+02, 1.0939732e+02, 1.2025422e+02, 1.2199762e+02, 1.0174778e+02, 7.8540125e+01, 9.5025154e+01, 1.1165914e+02, 1.1023324e+02, 9.1242339e+01, 8.5951891e+01, 1.0369135e+02, 1.0331141e+02, 9.9723003e+01, 1.1285122e+02, 1.2463409e+02, 1.2552850e+02, 1.1854196e+02, 8.0619714e+01, 8.1379654e+01, 1.4245861e+02, 1.8156280e+02, 1.5038015e+02, 1.0734593e+02, 9.5297044e+01, 1.0530156e+02},
                {1.0888863e+02, 1.2530567e+02, 1.4481809e+02, 1.5187417e+02, 1.4410388e+02, 1.0843965e+02, 8.0266287e+01, 1.0549539e+02, 1.2366327e+02, 1.2696694e+02, 1.1079747e+02, 7.6881913e+01, 1.0319945e+02, 1.4325822e+02, 1.4305269e+02, 1.2413205e+02, 8.1397892e+01, 7.9165699e+01, 9.8877701e+01, 9.8702991e+01, 1.2445222e+02, 1.5260112e+02, 1.5486260e+02, 1.3686016e+02, 1.1644399e+02, 1.1487222e+02, 1.4613894e+02, 1.8174267e+02, 1.6350878e+02, 9.7196194e+01, 6.9291477e+01, 8.6741586e+01},
                {1.3908962e+02, 1.7124387e+02, 1.7083598e+02, 1.5109158e+02, 1.3733389e+02, 1.0548242e+02, 8.8624432e+01, 1.0621928e+02, 1.2058695e+02, 1.1985121e+02, 9.8153731e+01, 7.3048665e+01, 1.0620406e+02, 1.4909284e+02, 1.4609043e+02, 1.2501423e+02, 9.4136873e+01, 9.0489284e+01, 1.1513532e+02, 1.0899527e+02, 1.1582719e+02, 1.5421585e+02, 1.5857962e+02, 1.2946300e+02, 1.2124255e+02, 1.3549897e+02, 1.4630042e+02, 1.5648575e+02, 1.3363014e+02, 8.2294789e+01, 7.1167710e+01, 9.8574064e+01},
                {1.2872228e+02, 1.5572062e+02, 1.6649448e+02, 1.4786687e+02, 1.5056801e+02, 1.3229046e+02, 1.3462830e+02, 1.1252166e+02, 1.1313603e+02, 1.4197816e+02, 1.3860305e+02, 1.0380374e+02, 9.7067058e+01, 1.1466022e+02, 1.1733057e+02, 1.0664950e+02, 1.0815119e+02, 1.0401497e+02, 1.0347717e+02, 9.1257175e+01, 1.0125995e+02, 1.5044126e+02, 1.4411882e+02, 9.8886063e+01, 1.0045119e+02, 1.2036724e+02, 1.2997421e+02, 1.3065159e+02, 1.1189262e+02, 1.0463400e+02, 1.0971286e+02, 1.3866868e+02},
                {1.2444941e+02, 1.5467297e+02, 1.7151525e+02, 1.4219993e+02, 1.5580178e+02, 1.4555965e+02, 1.4222633e+02, 1.3515942e+02, 1.0897568e+02, 1.2680733e+02, 1.4830943e+02, 1.2514592e+02, 1.1364017e+02, 1.4250338e+02, 1.5287977e+02, 1.2621342e+02, 8.9392218e+01, 8.9945270e+01, 8.6925592e+01, 7.0526748e+01, 9.3777013e+01, 1.3332045e+02, 1.0499241e+02, 5.2272287e+01, 6.8043148e+01, 7.7153015e+01, 7.6608473e+01, 1.0611292e+02, 1.5701966e+02, 1.6539589e+02, 1.3170320e+02, 1.1975188e+02},
                {1.5686112e+02, 1.5163412e+02, 1.4432239e+02, 1.4125524e+02, 1.6471355e+02, 2.1036956e+02, 1.6914149e+02, 1.4483986e+02, 1.3146856e+02, 1.2216632e+02, 1.1522531e+02, 1.1695863e+02, 1.4240118e+02, 1.7594051e+02, 1.9323566e+02, 1.5199117e+02, 9.0769928e+01, 9.9309069e+01, 8.6616173e+01, 7.7728428e+01, 1.0399607e+02, 1.2750960e+02, 1.0205034e+02, 8.8202695e+01, 1.0543704e+02, 1.0245533e+02, 9.0184591e+01, 1.1008475e+02, 1.7119236e+02, 1.6188653e+02, 1.1828498e+02, 7.4767454e+01},
                {1.9209790e+02, 1.5668296e+02, 1.5449895e+02, 1.8078608e+02, 1.7700472e+02, 2.4643698e+02, 2.0705725e+02, 1.7260637e+02, 1.9764952e+02, 1.9256952e+02, 1.5794313e+02, 1.4754260e+02, 1.4706566e+02, 1.7000506e+02, 2.0774335e+02, 1.7939771e+02, 1.1483486e+02, 1.2358094e+02, 1.3005796e+02, 1.3429668e+02, 1.4668093e+02, 1.5007458e+02, 1.4368723e+02, 1.3690152e+02, 1.2321679e+02, 1.1914470e+02, 1.3776489e+02, 1.0882574e+02, 1.3327832e+02, 1.2573292e+02, 1.1408262e+02, 1.0775155e+02},
                {1.8331324e+02, 1.8756132e+02, 2.1359085e+02, 2.0963528e+02, 1.6404664e+02, 2.0258636e+02, 2.0361805e+02, 2.1942664e+02, 2.5141514e+02, 2.0559674e+02, 1.6213338e+02, 1.7052008e+02, 1.8778065e+02, 1.9733824e+02, 2.0100675e+02, 1.8595101e+02, 1.1397651e+02, 1.1231951e+02, 1.5736604e+02, 1.6800644e+02, 1.6713941e+02, 1.5249316e+02, 1.3030857e+02, 1.2360068e+02, 1.0812322e+02, 1.0636845e+02, 1.1477721e+02, 8.4490955e+01, 1.3340482e+02, 1.5488769e+02, 1.3941172e+02, 1.5180522e+02},
                {2.0519351e+02, 2.2812865e+02, 2.3470955e+02, 1.9192565e+02, 1.5211758e+02, 1.5133931e+02, 1.9990901e+02, 2.6598476e+02, 2.8049559e+02, 2.2783018e+02, 1.5475441e+02, 1.7786458e+02, 2.3729879e+02, 2.6233874e+02, 2.6332548e+02, 2.3679543e+02, 1.7900370e+02, 1.6007055e+02, 1.7664895e+02, 1.7816646e+02, 1.6267795e+02, 1.4117288e+02, 9.6093042e+01, 9.0785267e+01, 1.1828649e+02, 1.1683154e+02, 8.8329714e+01, 8.1222478e+01, 1.3574537e+02, 1.6098460e+02, 1.6890705e+02, 1.7206275e+02},
                {2.6514745e+02, 3.2921393e+02, 2.7133692e+02, 1.8913523e+02, 1.5734822e+02, 1.8253126e+02, 2.1965119e+02, 2.7812612e+02, 2.6349802e+02, 2.1653791e+02, 1.7875792e+02, 2.1296176e+02, 2.7252499e+02, 3.1505831e+02, 3.3549827e+02, 3.2102805e+02, 2.6333760e+02, 2.3492737e+02, 2.0203585e+02, 2.0444110e+02, 1.9010235e+02, 1.4152578e+02, 1.3793327e+02, 1.5991054e+02, 1.6979436e+02, 1.2671732e+02, 1.1054145e+02, 9.7755422e+01, 1.1675488e+02, 1.1416236e+02, 1.4282879e+02, 1.0487602e+02},
                {2.6406358e+02, 3.1844006e+02, 2.4697866e+02, 2.1904100e+02, 1.8888586e+02, 2.2111274e+02, 2.3882315e+02, 2.4646910e+02, 2.0168744e+02, 1.8176312e+02, 2.0986969e+02, 2.3869860e+02, 2.9253014e+02, 2.9167502e+02, 2.8322061e+02, 3.0996481e+02, 2.8741632e+02, 2.7505191e+02, 2.3858139e+02, 2.5666309e+02, 2.6350558e+02, 2.2274382e+02, 2.0682893e+02, 2.1412709e+02, 2.1324913e+02, 1.5411165e+02, 1.2931620e+02, 9.1000214e+01, 9.7720681e+01, 9.1653364e+01, 1.0015467e+02, 7.5652400e+01},
                {2.8664221e+02, 2.8283579e+02, 1.7618789e+02, 2.0894831e+02, 2.0018189e+02, 2.0214695e+02, 2.5096306e+02, 2.6355255e+02, 2.3264890e+02, 2.4112652e+02, 2.5006762e+02, 2.0459113e+02, 2.2857055e+02, 1.9461957e+02, 1.6674744e+02, 2.1948564e+02, 2.4541567e+02, 2.7475923e+02, 2.4292770e+02, 2.4663737e+02, 2.4860632e+02, 2.4797221e+02, 2.3628196e+02, 2.2370600e+02, 2.4973046e+02, 1.9634495e+02, 1.3134044e+02, 1.2499980e+02, 1.8867603e+02, 2.0317220e+02, 1.9068360e+02, 1.7843004e+02},
                {3.0626034e+02, 3.5347621e+02, 2.5475672e+02, 2.3274209e+02, 1.9871318e+02, 1.9441102e+02, 2.8595406e+02, 3.6197899e+02, 3.3186653e+02, 3.0129594e+02, 3.1351419e+02, 2.9492869e+02, 2.2202440e+02, 1.9023830e+02, 1.7702754e+02, 1.7509252e+02, 1.9400703e+02, 2.3592746e+02, 2.1923834e+02, 1.9505100e+02, 1.2090356e+02, 1.3684229e+02, 1.7147050e+02, 1.7000906e+02, 2.2864351e+02, 2.0773860e+02, 1.7404750e+02, 1.7958437e+02, 2.7312907e+02, 2.8279257e+02, 2.3746641e+02, 1.7986798e+02},
                {2.0850710e+02, 2.5685419e+02, 2.4651362e+02, 2.5464842e+02, 2.1234075e+02, 1.9320850e+02, 3.1651901e+02, 4.0847860e+02, 3.7386864e+02, 3.1677706e+02, 3.5485421e+02, 3.9807819e+02, 3.2649656e+02, 2.6108284e+02, 2.1176661e+02, 1.7396632e+02, 1.8186326e+02, 2.2991704e+02, 2.3618176e+02, 1.7384273e+02, 1.2304504e+02, 1.0569191e+02, 9.8328922e+01, 1.2439152e+02, 1.4789147e+02, 1.8306152e+02, 2.2777436e+02, 1.9292495e+02, 2.4371909e+02, 2.6376900e+02, 2.3378759e+02, 1.7384922e+02},
                {2.0266783e+02, 1.6608734e+02, 1.3537378e+02, 2.0454035e+02, 2.0094622e+02, 1.7447973e+02, 2.4128844e+02, 2.8759888e+02, 2.8697419e+02, 2.8348152e+02, 2.9685261e+02, 3.2870232e+02, 3.1720630e+02, 2.5638754e+02, 1.9086728e+02, 1.5454782e+02, 2.0105118e+02, 2.5166937e+02, 2.3540583e+02, 1.9667255e+02, 1.8282701e+02, 1.6251259e+02, 1.5822107e+02, 1.8547163e+02, 1.5613765e+02, 1.5087237e+02, 1.9551903e+02, 1.5843838e+02, 1.7729238e+02, 1.9885900e+02, 1.9594934e+02, 1.9309847e+02},
                {3.1443948e+02, 2.7189709e+02, 1.5199034e+02, 1.7743903e+02, 1.9218743e+02, 1.8143571e+02, 1.3562282e+02, 1.2976278e+02, 2.1203867e+02, 2.6586251e+02, 2.1109373e+02, 2.2884329e+02, 2.4934097e+02, 2.0276293e+02, 2.1081321e+02, 1.8336453e+02, 2.0708764e+02, 2.3359939e+02, 2.0032873e+02, 2.2843777e+02, 2.1504273e+02, 1.8722323e+02, 2.0437066e+02, 2.0777195e+02, 1.5552330e+02, 1.1449369e+02, 1.4692260e+02, 1.2520174e+02, 1.2735346e+02, 1.5267351e+02, 1.7812666e+02, 1.9094845e+02},
                {2.9183702e+02, 2.6450673e+02, 1.4545880e+02, 1.4326168e+02, 1.5164465e+02, 1.5469392e+02, 1.8673864e+02, 2.8639799e+02, 3.0880145e+02, 2.6880736e+02, 2.1655411e+02, 2.4624392e+02, 2.2611366e+02, 1.8734736e+02, 2.4012505e+02, 2.3126162e+02, 2.2932557e+02, 2.0234570e+02, 1.4929647e+02, 2.2949323e+02, 2.7729869e+02, 2.5410258e+02, 2.3901769e+02, 2.2461763e+02, 2.1259471e+02, 1.9971950e+02, 1.8602791e+02, 1.4268732e+02, 1.3604169e+02, 1.9436662e+02, 2.4052080e+02, 1.6874992e+02},
                {2.2029986e+02, 2.3794235e+02, 1.8858340e+02, 1.5884649e+02, 1.0370171e+02, 1.0117383e+02, 1.8269318e+02, 3.0261628e+02, 2.9873993e+02, 2.3190736e+02, 2.0827043e+02, 2.1516528e+02, 1.9632644e+02, 1.8375069e+02, 1.8468299e+02, 1.9683425e+02, 2.3573626e+02, 1.9379072e+02, 1.4782374e+02, 2.1179140e+02, 2.6612607e+02, 2.7289356e+02, 2.4756102e+02, 2.4495914e+02, 2.9133910e+02, 2.6733737e+02, 1.7663729e+02, 1.6301478e+02, 1.9237885e+02, 2.1246507e+02, 2.3444323e+02, 1.5616794e+02},
                {2.3663355e+02, 2.8407835e+02, 2.7169128e+02, 2.1120412e+02, 1.3913115e+02, 1.3647726e+02, 1.5311819e+02, 1.8872601e+02, 1.8962244e+02, 1.5929836e+02, 1.5271264e+02, 1.7808855e+02, 1.8162117e+02, 1.6788033e+02, 1.4832891e+02, 1.7063263e+02, 2.1112499e+02, 2.0855581e+02, 1.8416248e+02, 1.6797385e+02, 1.8139376e+02, 2.0255785e+02, 1.7944201e+02, 1.6857419e+02, 2.3378170e+02, 1.9470128e+02, 1.4793751e+02, 2.0976275e+02, 2.2715231e+02, 1.5777901e+02, 1.4572604e+02, 1.5612953e+02}};

        final double[][] sIi = {
                {6.5732631e-01, -6.5732631e-01,  6.5732631e-01, -6.5732631e-01,  6.5732631e-01, -6.5732631e-01,  6.5732631e-01, -6.5732631e-01,  6.5732631e-01, -6.5732631e-01,  6.5732631e-01, -6.5732631e-01,  6.5732631e-01, -6.5732631e-01,  6.5732631e-01, -6.5732631e-01,  6.5732631e-01, -6.5732631e-01,  6.5732631e-01, -6.5732631e-01,  6.5732631e-01, -6.5732631e-01,  6.5732631e-01, -6.5732631e-01,  6.5732631e-01, -6.5732631e-01,  6.5732631e-01, -6.5732631e-01,  6.5732631e-01, -6.5732631e-01,  6.5732631e-01, -6.5732631e-01},
                {-2.0225425e-01,  2.0225425e-01, -2.0225425e-01,  2.0225425e-01, -2.0225425e-01,  2.0225425e-01, -2.0225425e-01,  2.0225425e-01, -2.0225425e-01,  2.0225425e-01, -2.0225425e-01,  2.0225425e-01, -2.0225425e-01,  2.0225425e-01, -2.0225425e-01,  2.0225425e-01, -2.0225425e-01,  2.0225425e-01, -2.0225425e-01,  2.0225425e-01, -2.0225425e-01,  2.0225425e-01, -2.0225425e-01,  2.0225425e-01, -2.0225425e-01,  2.0225425e-01, -2.0225425e-01,  2.0225425e-01, -2.0225425e-01,  2.0225425e-01, -2.0225425e-01,  2.0225425e-01},
                {-9.6070768e-01,  9.6070768e-01, -9.6070768e-01,  9.6070768e-01, -9.6070768e-01,  9.6070768e-01, -9.6070768e-01,  9.6070768e-01, -9.6070768e-01,  9.6070768e-01, -9.6070768e-01,  9.6070768e-01, -9.6070768e-01,  9.6070768e-01, -9.6070768e-01,  9.6070768e-01, -9.6070768e-01,  9.6070768e-01, -9.6070768e-01,  9.6070768e-01, -9.6070768e-01,  9.6070768e-01, -9.6070768e-01,  9.6070768e-01, -9.6070768e-01,  9.6070768e-01, -9.6070768e-01,  9.6070768e-01, -9.6070768e-01,  9.6070768e-01, -9.6070768e-01,  9.6070768e-01},
                {5.0563562e-01, -5.0563562e-01,  5.0563562e-01, -5.0563562e-01,  5.0563562e-01, -5.0563562e-01,  5.0563562e-01, -5.0563562e-01,  5.0563562e-01, -5.0563562e-01,  5.0563562e-01, -5.0563562e-01,  5.0563562e-01, -5.0563562e-01,  5.0563562e-01, -5.0563562e-01,  5.0563562e-01, -5.0563562e-01,  5.0563562e-01, -5.0563562e-01,  5.0563562e-01, -5.0563562e-01,  5.0563562e-01, -5.0563562e-01,  5.0563562e-01, -5.0563562e-01,  5.0563562e-01, -5.0563562e-01,  5.0563562e-01, -5.0563562e-01,  5.0563562e-01, -5.0563562e-01},
                {9.1014412e-01, -9.1014412e-01,  9.1014412e-01, -9.1014412e-01,  9.1014412e-01, -9.1014412e-01,  9.1014412e-01, -9.1014412e-01,  9.1014412e-01, -9.1014412e-01,  9.1014412e-01, -9.1014412e-01,  9.1014412e-01, -9.1014412e-01,  9.1014412e-01, -9.1014412e-01,  9.1014412e-01, -9.1014412e-01,  9.1014412e-01, -9.1014412e-01,  9.1014412e-01, -9.1014412e-01,  9.1014412e-01, -9.1014412e-01,  9.1014412e-01, -9.1014412e-01,  9.1014412e-01, -9.1014412e-01,  9.1014412e-01, -9.1014412e-01,  9.1014412e-01, -9.1014412e-01},
                {1.1629619e+00, -1.1629619e+00,  1.1629619e+00, -1.1629619e+00,  1.1629619e+00, -1.1629619e+00,  1.1629619e+00, -1.1629619e+00,  1.1629619e+00, -1.1629619e+00,  1.1629619e+00, -1.1629619e+00,  1.1629619e+00, -1.1629619e+00,  1.1629619e+00, -1.1629619e+00,  1.1629619e+00, -1.1629619e+00,  1.1629619e+00, -1.1629619e+00,  1.1629619e+00, -1.1629619e+00,  1.1629619e+00, -1.1629619e+00,  1.1629619e+00, -1.1629619e+00,  1.1629619e+00, -1.1629619e+00,  1.1629619e+00, -1.1629619e+00,  1.1629619e+00, -1.1629619e+00},
                {1.5169069e-01, -1.5169069e-01,  1.5169069e-01, -1.5169069e-01,  1.5169069e-01, -1.5169069e-01,  1.5169069e-01, -1.5169069e-01,  1.5169069e-01, -1.5169069e-01,  1.5169069e-01, -1.5169069e-01,  1.5169069e-01, -1.5169069e-01,  1.5169069e-01, -1.5169069e-01,  1.5169069e-01, -1.5169069e-01,  1.5169069e-01, -1.5169069e-01,  1.5169069e-01, -1.5169069e-01,  1.5169069e-01, -1.5169069e-01,  1.5169069e-01, -1.5169069e-01,  1.5169069e-01, -1.5169069e-01,  1.5169069e-01, -1.5169069e-01,  1.5169069e-01, -1.5169069e-01},
                {-1.2640891e+00,  1.2640891e+00, -1.2640891e+00,  1.2640891e+00, -1.2640891e+00,  1.2640891e+00, -1.2640891e+00,  1.2640891e+00, -1.2640891e+00,  1.2640891e+00, -1.2640891e+00,  1.2640891e+00, -1.2640891e+00,  1.2640891e+00, -1.2640891e+00,  1.2640891e+00, -1.2640891e+00,  1.2640891e+00, -1.2640891e+00,  1.2640891e+00, -1.2640891e+00,  1.2640891e+00, -1.2640891e+00,  1.2640891e+00, -1.2640891e+00,  1.2640891e+00, -1.2640891e+00,  1.2640891e+00, -1.2640891e+00,  1.2640891e+00, -1.2640891e+00,  1.2640891e+00},
                {-6.5732631e-01,  6.5732631e-01, -6.5732631e-01,  6.5732631e-01, -6.5732631e-01,  6.5732631e-01, -6.5732631e-01,  6.5732631e-01, -6.5732631e-01,  6.5732631e-01, -6.5732631e-01,  6.5732631e-01, -6.5732631e-01,  6.5732631e-01, -6.5732631e-01,  6.5732631e-01, -6.5732631e-01,  6.5732631e-01, -6.5732631e-01,  6.5732631e-01, -6.5732631e-01,  6.5732631e-01, -6.5732631e-01,  6.5732631e-01, -6.5732631e-01,  6.5732631e-01, -6.5732631e-01,  6.5732631e-01, -6.5732631e-01,  6.5732631e-01, -6.5732631e-01,  6.5732631e-01},
                {9.6070768e-01, -9.6070768e-01,  9.6070768e-01, -9.6070768e-01,  9.6070768e-01, -9.6070768e-01,  9.6070768e-01, -9.6070768e-01,  9.6070768e-01, -9.6070768e-01,  9.6070768e-01, -9.6070768e-01,  9.6070768e-01, -9.6070768e-01,  9.6070768e-01, -9.6070768e-01,  9.6070768e-01, -9.6070768e-01,  9.6070768e-01, -9.6070768e-01,  9.6070768e-01, -9.6070768e-01,  9.6070768e-01, -9.6070768e-01,  9.6070768e-01, -9.6070768e-01,  9.6070768e-01, -9.6070768e-01,  9.6070768e-01, -9.6070768e-01,  9.6070768e-01, -9.6070768e-01},
                {5.0563562e-01, -5.0563562e-01,  5.0563562e-01, -5.0563562e-01,  5.0563562e-01, -5.0563562e-01,  5.0563562e-01, -5.0563562e-01,  5.0563562e-01, -5.0563562e-01,  5.0563562e-01, -5.0563562e-01,  5.0563562e-01, -5.0563562e-01,  5.0563562e-01, -5.0563562e-01,  5.0563562e-01, -5.0563562e-01,  5.0563562e-01, -5.0563562e-01,  5.0563562e-01, -5.0563562e-01,  5.0563562e-01, -5.0563562e-01,  5.0563562e-01, -5.0563562e-01,  5.0563562e-01, -5.0563562e-01,  5.0563562e-01, -5.0563562e-01,  5.0563562e-01, -5.0563562e-01},
                {8.0901699e-01, -8.0901699e-01,  8.0901699e-01, -8.0901699e-01,  8.0901699e-01, -8.0901699e-01,  8.0901699e-01, -8.0901699e-01,  8.0901699e-01, -8.0901699e-01,  8.0901699e-01, -8.0901699e-01,  8.0901699e-01, -8.0901699e-01,  8.0901699e-01, -8.0901699e-01,  8.0901699e-01, -8.0901699e-01,  8.0901699e-01, -8.0901699e-01,  8.0901699e-01, -8.0901699e-01,  8.0901699e-01, -8.0901699e-01,  8.0901699e-01, -8.0901699e-01,  8.0901699e-01, -8.0901699e-01,  8.0901699e-01, -8.0901699e-01,  8.0901699e-01, -8.0901699e-01},
                {5.0563562e-01, -5.0563562e-01,  5.0563562e-01, -5.0563562e-01,  5.0563562e-01, -5.0563562e-01,  5.0563562e-01, -5.0563562e-01,  5.0563562e-01, -5.0563562e-01,  5.0563562e-01, -5.0563562e-01,  5.0563562e-01, -5.0563562e-01,  5.0563562e-01, -5.0563562e-01,  5.0563562e-01, -5.0563562e-01,  5.0563562e-01, -5.0563562e-01,  5.0563562e-01, -5.0563562e-01,  5.0563562e-01, -5.0563562e-01,  5.0563562e-01, -5.0563562e-01,  5.0563562e-01, -5.0563562e-01,  5.0563562e-01, -5.0563562e-01,  5.0563562e-01, -5.0563562e-01},
                {-4.0450850e-01,  4.0450850e-01, -4.0450850e-01,  4.0450850e-01, -4.0450850e-01,  4.0450850e-01, -4.0450850e-01,  4.0450850e-01, -4.0450850e-01,  4.0450850e-01, -4.0450850e-01,  4.0450850e-01, -4.0450850e-01,  4.0450850e-01, -4.0450850e-01,  4.0450850e-01, -4.0450850e-01,  4.0450850e-01, -4.0450850e-01,  4.0450850e-01, -4.0450850e-01,  4.0450850e-01, -4.0450850e-01,  4.0450850e-01, -4.0450850e-01,  4.0450850e-01, -4.0450850e-01,  4.0450850e-01, -4.0450850e-01,  4.0450850e-01, -4.0450850e-01,  4.0450850e-01},
                {1.5169069e-01, -1.5169069e-01,  1.5169069e-01, -1.5169069e-01,  1.5169069e-01, -1.5169069e-01,  1.5169069e-01, -1.5169069e-01,  1.5169069e-01, -1.5169069e-01,  1.5169069e-01, -1.5169069e-01,  1.5169069e-01, -1.5169069e-01,  1.5169069e-01, -1.5169069e-01,  1.5169069e-01, -1.5169069e-01,  1.5169069e-01, -1.5169069e-01,  1.5169069e-01, -1.5169069e-01,  1.5169069e-01, -1.5169069e-01,  1.5169069e-01, -1.5169069e-01,  1.5169069e-01, -1.5169069e-01,  1.5169069e-01, -1.5169069e-01,  1.5169069e-01, -1.5169069e-01},
                {2.5281781e-01, -2.5281781e-01,  2.5281781e-01, -2.5281781e-01,  2.5281781e-01, -2.5281781e-01,  2.5281781e-01, -2.5281781e-01,  2.5281781e-01, -2.5281781e-01,  2.5281781e-01, -2.5281781e-01,  2.5281781e-01, -2.5281781e-01,  2.5281781e-01, -2.5281781e-01,  2.5281781e-01, -2.5281781e-01,  2.5281781e-01, -2.5281781e-01,  2.5281781e-01, -2.5281781e-01,  2.5281781e-01, -2.5281781e-01,  2.5281781e-01, -2.5281781e-01,  2.5281781e-01, -2.5281781e-01,  2.5281781e-01, -2.5281781e-01,  2.5281781e-01, -2.5281781e-01},
                {5.0563562e-02, -5.0563562e-02,  5.0563562e-02, -5.0563562e-02,  5.0563562e-02, -5.0563562e-02,  5.0563562e-02, -5.0563562e-02,  5.0563562e-02, -5.0563562e-02,  5.0563562e-02, -5.0563562e-02,  5.0563562e-02, -5.0563562e-02,  5.0563562e-02, -5.0563562e-02,  5.0563562e-02, -5.0563562e-02,  5.0563562e-02, -5.0563562e-02,  5.0563562e-02, -5.0563562e-02,  5.0563562e-02, -5.0563562e-02,  5.0563562e-02, -5.0563562e-02,  5.0563562e-02, -5.0563562e-02,  5.0563562e-02, -5.0563562e-02,  5.0563562e-02, -5.0563562e-02},
                {5.8148096e-01, -5.8148096e-01,  5.8148096e-01, -5.8148096e-01,  5.8148096e-01, -5.8148096e-01,  5.8148096e-01, -5.8148096e-01,  5.8148096e-01, -5.8148096e-01,  5.8148096e-01, -5.8148096e-01,  5.8148096e-01, -5.8148096e-01,  5.8148096e-01, -5.8148096e-01,  5.8148096e-01, -5.8148096e-01,  5.8148096e-01, -5.8148096e-01,  5.8148096e-01, -5.8148096e-01,  5.8148096e-01, -5.8148096e-01,  5.8148096e-01, -5.8148096e-01,  5.8148096e-01, -5.8148096e-01,  5.8148096e-01, -5.8148096e-01,  5.8148096e-01, -5.8148096e-01},
                {1.2388073e+00, -1.2388073e+00,  1.2388073e+00, -1.2388073e+00,  1.2388073e+00, -1.2388073e+00,  1.2388073e+00, -1.2388073e+00,  1.2388073e+00, -1.2388073e+00,  1.2388073e+00, -1.2388073e+00,  1.2388073e+00, -1.2388073e+00,  1.2388073e+00, -1.2388073e+00,  1.2388073e+00, -1.2388073e+00,  1.2388073e+00, -1.2388073e+00,  1.2388073e+00, -1.2388073e+00,  1.2388073e+00, -1.2388073e+00,  1.2388073e+00, -1.2388073e+00,  1.2388073e+00, -1.2388073e+00,  1.2388073e+00, -1.2388073e+00,  1.2388073e+00, -1.2388073e+00},
                {1.3904980e+00, -1.3904980e+00,  1.3904980e+00, -1.3904980e+00,  1.3904980e+00, -1.3904980e+00,  1.3904980e+00, -1.3904980e+00,  1.3904980e+00, -1.3904980e+00,  1.3904980e+00, -1.3904980e+00,  1.3904980e+00, -1.3904980e+00,  1.3904980e+00, -1.3904980e+00,  1.3904980e+00, -1.3904980e+00,  1.3904980e+00, -1.3904980e+00,  1.3904980e+00, -1.3904980e+00,  1.3904980e+00, -1.3904980e+00,  1.3904980e+00, -1.3904980e+00,  1.3904980e+00, -1.3904980e+00,  1.3904980e+00, -1.3904980e+00,  1.3904980e+00, -1.3904980e+00},
                {-5.0563562e-02,  5.0563562e-02, -5.0563562e-02,  5.0563562e-02, -5.0563562e-02,  5.0563562e-02, -5.0563562e-02,  5.0563562e-02, -5.0563562e-02,  5.0563562e-02, -5.0563562e-02,  5.0563562e-02, -5.0563562e-02,  5.0563562e-02, -5.0563562e-02,  5.0563562e-02, -5.0563562e-02,  5.0563562e-02, -5.0563562e-02,  5.0563562e-02, -5.0563562e-02,  5.0563562e-02, -5.0563562e-02,  5.0563562e-02, -5.0563562e-02,  5.0563562e-02, -5.0563562e-02,  5.0563562e-02, -5.0563562e-02,  5.0563562e-02, -5.0563562e-02,  5.0563562e-02},
                {4.2979028e-01, -4.2979028e-01,  4.2979028e-01, -4.2979028e-01,  4.2979028e-01, -4.2979028e-01,  4.2979028e-01, -4.2979028e-01,  4.2979028e-01, -4.2979028e-01,  4.2979028e-01, -4.2979028e-01,  4.2979028e-01, -4.2979028e-01,  4.2979028e-01, -4.2979028e-01,  4.2979028e-01, -4.2979028e-01,  4.2979028e-01, -4.2979028e-01,  4.2979028e-01, -4.2979028e-01,  4.2979028e-01, -4.2979028e-01,  4.2979028e-01, -4.2979028e-01,  4.2979028e-01, -4.2979028e-01,  4.2979028e-01, -4.2979028e-01,  4.2979028e-01, -4.2979028e-01},
                {2.9326866e+00, -2.9326866e+00,  2.9326866e+00, -2.9326866e+00,  2.9326866e+00, -2.9326866e+00,  2.9326866e+00, -2.9326866e+00,  2.9326866e+00, -2.9326866e+00,  2.9326866e+00, -2.9326866e+00,  2.9326866e+00, -2.9326866e+00,  2.9326866e+00, -2.9326866e+00,  2.9326866e+00, -2.9326866e+00,  2.9326866e+00, -2.9326866e+00,  2.9326866e+00, -2.9326866e+00,  2.9326866e+00, -2.9326866e+00,  2.9326866e+00, -2.9326866e+00,  2.9326866e+00, -2.9326866e+00,  2.9326866e+00, -2.9326866e+00,  2.9326866e+00, -2.9326866e+00},
                {2.3512056e+00, -2.3512056e+00,  2.3512056e+00, -2.3512056e+00,  2.3512056e+00, -2.3512056e+00,  2.3512056e+00, -2.3512056e+00,  2.3512056e+00, -2.3512056e+00,  2.3512056e+00, -2.3512056e+00,  2.3512056e+00, -2.3512056e+00,  2.3512056e+00, -2.3512056e+00,  2.3512056e+00, -2.3512056e+00,  2.3512056e+00, -2.3512056e+00,  2.3512056e+00, -2.3512056e+00,  2.3512056e+00, -2.3512056e+00,  2.3512056e+00, -2.3512056e+00,  2.3512056e+00, -2.3512056e+00,  2.3512056e+00, -2.3512056e+00,  2.3512056e+00, -2.3512056e+00},
                {5.3091740e-01, -5.3091740e-01,  5.3091740e-01, -5.3091740e-01,  5.3091740e-01, -5.3091740e-01,  5.3091740e-01, -5.3091740e-01,  5.3091740e-01, -5.3091740e-01,  5.3091740e-01, -5.3091740e-01,  5.3091740e-01, -5.3091740e-01,  5.3091740e-01, -5.3091740e-01,  5.3091740e-01, -5.3091740e-01,  5.3091740e-01, -5.3091740e-01,  5.3091740e-01, -5.3091740e-01,  5.3091740e-01, -5.3091740e-01,  5.3091740e-01, -5.3091740e-01,  5.3091740e-01, -5.3091740e-01,  5.3091740e-01, -5.3091740e-01,  5.3091740e-01, -5.3091740e-01},
                {7.3317165e-01, -7.3317165e-01,  7.3317165e-01, -7.3317165e-01,  7.3317165e-01, -7.3317165e-01,  7.3317165e-01, -7.3317165e-01,  7.3317165e-01, -7.3317165e-01,  7.3317165e-01, -7.3317165e-01,  7.3317165e-01, -7.3317165e-01,  7.3317165e-01, -7.3317165e-01,  7.3317165e-01, -7.3317165e-01,  7.3317165e-01, -7.3317165e-01,  7.3317165e-01, -7.3317165e-01,  7.3317165e-01, -7.3317165e-01,  7.3317165e-01, -7.3317165e-01,  7.3317165e-01, -7.3317165e-01,  7.3317165e-01, -7.3317165e-01,  7.3317165e-01, -7.3317165e-01},
                {1.4157797e+00, -1.4157797e+00,  1.4157797e+00, -1.4157797e+00,  1.4157797e+00, -1.4157797e+00,  1.4157797e+00, -1.4157797e+00,  1.4157797e+00, -1.4157797e+00,  1.4157797e+00, -1.4157797e+00,  1.4157797e+00, -1.4157797e+00,  1.4157797e+00, -1.4157797e+00,  1.4157797e+00, -1.4157797e+00,  1.4157797e+00, -1.4157797e+00,  1.4157797e+00, -1.4157797e+00,  1.4157797e+00, -1.4157797e+00,  1.4157797e+00, -1.4157797e+00,  1.4157797e+00, -1.4157797e+00,  1.4157797e+00, -1.4157797e+00,  1.4157797e+00, -1.4157797e+00},
                {9.1014412e-01, -9.1014412e-01,  9.1014412e-01, -9.1014412e-01,  9.1014412e-01, -9.1014412e-01,  9.1014412e-01, -9.1014412e-01,  9.1014412e-01, -9.1014412e-01,  9.1014412e-01, -9.1014412e-01,  9.1014412e-01, -9.1014412e-01,  9.1014412e-01, -9.1014412e-01,  9.1014412e-01, -9.1014412e-01,  9.1014412e-01, -9.1014412e-01,  9.1014412e-01, -9.1014412e-01,  9.1014412e-01, -9.1014412e-01,  9.1014412e-01, -9.1014412e-01,  9.1014412e-01, -9.1014412e-01,  9.1014412e-01, -9.1014412e-01,  9.1014412e-01, -9.1014412e-01},
                {1.3146526e+00, -1.3146526e+00,  1.3146526e+00, -1.3146526e+00,  1.3146526e+00, -1.3146526e+00,  1.3146526e+00, -1.3146526e+00,  1.3146526e+00, -1.3146526e+00,  1.3146526e+00, -1.3146526e+00,  1.3146526e+00, -1.3146526e+00,  1.3146526e+00, -1.3146526e+00,  1.3146526e+00, -1.3146526e+00,  1.3146526e+00, -1.3146526e+00,  1.3146526e+00, -1.3146526e+00,  1.3146526e+00, -1.3146526e+00,  1.3146526e+00, -1.3146526e+00,  1.3146526e+00, -1.3146526e+00,  1.3146526e+00, -1.3146526e+00,  1.3146526e+00, -1.3146526e+00},
                {1.6685976e+00, -1.6685976e+00,  1.6685976e+00, -1.6685976e+00,  1.6685976e+00, -1.6685976e+00,  1.6685976e+00, -1.6685976e+00,  1.6685976e+00, -1.6685976e+00,  1.6685976e+00, -1.6685976e+00,  1.6685976e+00, -1.6685976e+00,  1.6685976e+00, -1.6685976e+00,  1.6685976e+00, -1.6685976e+00,  1.6685976e+00, -1.6685976e+00,  1.6685976e+00, -1.6685976e+00,  1.6685976e+00, -1.6685976e+00,  1.6685976e+00, -1.6685976e+00,  1.6685976e+00, -1.6685976e+00,  1.6685976e+00, -1.6685976e+00,  1.6685976e+00, -1.6685976e+00},
                {1.0618348e+00, -1.0618348e+00,  1.0618348e+00, -1.0618348e+00,  1.0618348e+00, -1.0618348e+00,  1.0618348e+00, -1.0618348e+00,  1.0618348e+00, -1.0618348e+00,  1.0618348e+00, -1.0618348e+00,  1.0618348e+00, -1.0618348e+00,  1.0618348e+00, -1.0618348e+00,  1.0618348e+00, -1.0618348e+00,  1.0618348e+00, -1.0618348e+00,  1.0618348e+00, -1.0618348e+00,  1.0618348e+00, -1.0618348e+00,  1.0618348e+00, -1.0618348e+00,  1.0618348e+00, -1.0618348e+00,  1.0618348e+00, -1.0618348e+00,  1.0618348e+00, -1.0618348e+00},
                {9.1014412e-01, -9.1014412e-01,  9.1014412e-01, -9.1014412e-01,  9.1014412e-01, -9.1014412e-01,  9.1014412e-01, -9.1014412e-01,  9.1014412e-01, -9.1014412e-01,  9.1014412e-01, -9.1014412e-01,  9.1014412e-01, -9.1014412e-01,  9.1014412e-01, -9.1014412e-01,  9.1014412e-01, -9.1014412e-01,  9.1014412e-01, -9.1014412e-01,  9.1014412e-01, -9.1014412e-01,  9.1014412e-01, -9.1014412e-01,  9.1014412e-01, -9.1014412e-01,  9.1014412e-01, -9.1014412e-01,  9.1014412e-01, -9.1014412e-01,  9.1014412e-01, -9.1014412e-01}};

        final int w = 32;
        final int h = 32;

        ComplexDoubleMatrix master = new ComplexDoubleMatrix(h, w);
        ComplexDoubleMatrix slave = new ComplexDoubleMatrix(h, w);

        for (int y = 0; y < h; y++) {
            for (int x = 0; x < w; x++) {
                master.put(y, x, new ComplexDouble(mI[y][x], 0.0));
                slave.put(y, x, new ComplexDouble(sIr[y][x], sIi[y][x]));
            }
        }

        final double[] Offset = {0, 0};
        final int ovsfactor = 16;
        final int AccL = 16;
        final int AccP = 16;
        final double coherence = CoregistrationUtils.crossCorrelateFFT(Offset, master, slave, ovsfactor, AccL, AccP);
//        final double coherence = CoregistrationUtils.normalizedCrossCorrelation(Offset, master, slave, ovsfactor, AccL, AccP);
        System.out.println("Range Offset = " + Offset[1] + ", Azimuth Offset = " + Offset[0]);
        // Azimuth shift should be 0 and range shift should be around 0.3
    }
}
